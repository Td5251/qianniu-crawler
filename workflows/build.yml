# æ¯”å¦‚ï¼šä½ æ‰§è¡Œäº†å‘½ä»¤ git tag v1.0.0 && git push td v1.0.0ï¼Œè¿™æ—¶å·¥ä½œæµä¼šè‡ªåŠ¨è¯†åˆ«
# refs/tags/v1.0.0ï¼Œå› ä¸ºå®ƒä»¥ refs/tags/v å¼€å¤´ï¼ŒstartsWith(...) ä¸º trueï¼Œå°±ä¼šè§¦å‘å‘å¸ƒæµç¨‹ã€‚
# åˆ é™¤è¿œç¨‹tagï¼šgit push td :refs/tags/v1.0.0
# åˆ é™¤æœ¬åœ°tagï¼šgit tag -d v1.0.0
# name: Build/IMS
name: Build qianniu-crawler App for Windows

on:
  push:
    tags:
      - "v*" # Trigger only on tag pushes, e.g., v1.1.0
  workflow_dispatch: # Allow manual triggering

jobs:
  build:
    runs-on: windows-latest

    steps:
      # æ£€æŸ¥å­˜å‚¨åº“
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      # Set up Node.js environment è®¾ç½® Node.js ç¯å¢ƒ
      - name: âš™ï¸ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18.18.2

      # Install dependencies å®‰è£…ä¾èµ–
      - name: ğŸ“¦ Install dependencies
        run: npm install

      # Build the Electron app æ„å»º Electron åº”ç”¨
      - name: ğŸ”§ Build Electron app
        run: npm run build:win64

      # ä¸Šä¼ æ„å»ºäº§ç‰©
      - name: ğŸ“¤ Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: electron-win64-app
          path: out/make/**/ # Upload all build outputs (e.g., .exe files)
          retention-days: 1/24 # 1å°æ—¶ï¼ˆ1å¤©=24å°æ—¶ï¼‰
